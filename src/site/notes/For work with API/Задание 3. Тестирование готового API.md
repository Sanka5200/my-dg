---
{"dg-publish":true,"permalink":"/for-work-with-api/zadanie-3-testirovanie-gotovogo-api/","noteIcon":""}
---

### Начало выполнения задания
Импортировал проект коллеги, предварительно перенеся api.
Хотел изначально импортировать без api, но вовремя догадался, что так не получится.
![Pasted image 20240930145332.png](/img/user/Pasted%20image%2020240930145332.png)
_Рисунок 1 - Окно консоли после импорта данных готового проекта коллеги_
Далее приступил к выполнению сценариев.
### Сценарий 1
#### Описание сценария
Просматриваю комментарий к игре, игровой хитрости (ИХ) и обзора игры (review) от лица неавторизованного пользователя #Public. Проверка прав неавторизованного пользователя #Public на написание комментария к игре - в доступе должно быть отказано.
##### Этап 1. Запрос к api данных комментариев к игре
![Pasted image 20240930150849.png](/img/user/Pasted%20image%2020240930150849.png)
_Рисунок 2 - Результат выполнения запроса данных комментария к игре_
![Pasted image 20240930151745.png](/img/user/Pasted%20image%2020240930151745.png)
_Рисунок 3 - Доступ публичной роли к запросу api комментария к игре_
##### Этап 2. Запрос к api данных комментариев к ИХ
![Pasted image 20240930155040.png](/img/user/Pasted%20image%2020240930155040.png)
_Рисунок 4 - Результат выполнения запроса данных комментария к ИХ_
![Pasted image 20240930155126.png](/img/user/Pasted%20image%2020240930155126.png)
_Рисунок 5 - Доступ публичной роли к запросу api комментария к ИХ_
По _Рисунку 3 и 5_ видно, что роль не имеет доступа к findOne. Такой доступ был сделан весьма целесообразно, так как нет нужды запрашивать отдельный комментарий неавторизованному пользователю, а поиск конкретного контента можно осуществить через ctrl+f.
##### Этап 3. Запрос к api данных обзора игры
![Pasted image 20240930161445.png](/img/user/Pasted%20image%2020240930161445.png)
_Рисунок 6 - Результат выполнения запроса данных обзора игры_
![Pasted image 20240930161233.png](/img/user/Pasted%20image%2020240930161233.png)
_Рисунок 7 - Доступ публичной роли к запросу api обзора игры_
##### Этап 4. Запрос к api на написание комментария к игре
![Pasted image 20240930164637.png](/img/user/Pasted%20image%2020240930164637.png)
_Рисунок 8 - Отказ на запрос вставки комментария к игре неавторизованного пользователя_

**Вывод**: Успешно получены данные комментариев к игре и ИХ. Не вышло выполнить запрос на получение данных об обзоре игры неавторизованным пользователем. Проверен доступ неавторизованных пользователей ко вставке комментария к игре - отказано в доступе, что и требовалось, согласно ТЗ.
**Замечания**: Отмечу, что согласно _Рисунку 7_ неавторизованный пользователь не может запрашивать данные обзора игры, что расходится с ТЗ. Было бы логично разрешить ему это делать, чтобы избежать результата _Рисунка 6_.
### Сценарий 2
#### Описание сценария
Проверка полномочий роли авторизованного пользователя #Authenticated.
Проверка доступа авторизованного пользователя на создание комментария к игре и ИХ. Запрос контента ИХ авторизованным пользователем.
##### Этап 1. Создание комментария к игре
![Pasted image 20240930163934.png](/img/user/Pasted%20image%2020240930163934.png)
_Рисунок 9 - Успешное выполнение запроса на создания комментария к игре_
![Pasted image 20240930163140.png](/img/user/Pasted%20image%2020240930163140.png)
_Рисунок 10 - Доступ авторизованного пользователя к созданию комментариев к игре_
##### Этап 2. Создание комментария к ИХ
![Pasted image 20240930164233.png](/img/user/Pasted%20image%2020240930164233.png)
_Рисунок 11 - Успешное выполнение запроса на создания комментария к ИХ_
![Pasted image 20240930163152.png](/img/user/Pasted%20image%2020240930163152.png)
_Рисунок 12 - Доступ авторизованного пользователя к созданию комментариев к ИХ_
##### Этап 3. Запрос на поиск ИХ
![Pasted image 20240930165714.png](/img/user/Pasted%20image%2020240930165714.png)
_Рисунок 13 - Результат выполнения запроса контента ИХ (нет прав доступа)_
![Pasted image 20240930165352.png](/img/user/Pasted%20image%2020240930165352.png)
_Рисунок 14 - Доступ авторизованного пользователя к запросу контента ИХ_

**Вывод**: Успешное создание комментариев к игре и ИХ. Из-за настроек доступа к контенту ИХ роли авторизованного пользователя невозможно осуществить поиск ИХ - в доступе отказано (_Рисунок 13_)
**Замечания**: Следовало дать роли возможность запрашивать контент ИХ.
### Сценарий 3
#### Описание сценария
Проверка полномочий роли создателя контента #ContentMaker.
Управление контентом ИХ пользователям с ролью создателя контента.
##### Этап 1. Запрос на создание ролью ContentMaker контента ИХ
![Pasted image 20240930171244.png](/img/user/Pasted%20image%2020240930171244.png)
_Рисунок 15 - Успешное выполнение запроса на создания контента ИХ_
![Pasted image 20240930170341.png](/img/user/Pasted%20image%2020240930170341.png)
_Рисунок 16 - Доступ ContentMaker к запросу на создание контента ИХ_
##### Этап 2. Запрос на удаление ролью ContentMaker контента ИХ
Из _Рисунка 16_ видно, что удалять контент ИХ ContentMaker не может.
Попробуем удалить только что созданный контент под id{6}
![Pasted image 20240930171516.png](/img/user/Pasted%20image%2020240930171516.png)
_Рисунок 17 - Отказ в доступе на выполнение запроса на удаление контента ИХ_
**Вывод**: Успешно создан контент в виде строки с советом к ИХ. Созданный контент удалить не получилось из-за настроек роли.
**Замечания**: Следует добавить возможность роли "ContentMaker" удалять контент ИХ, так как в ТЗ это явно прописано.
### Сценарий 4
#### Описание сценария
Проверка полномочий роли администратора #Admin.
Проверка доступа к разделу с контентом ИХ.
Удаление комментариев к играм и ИХ. Удаление обзоров к играм. 
##### Этап 1. Проверка доступа к разделу с контентом ИХ
В ТЗ явно указано, что данная роль имеет доступ к разделу ИХ, что расходится с имеющимся результатом. Результат выполнения запросов во всех случаях будет получать отказ, в связи с несоответствующим уровнем доступа к разделу.
![Pasted image 20240930172234.png](/img/user/Pasted%20image%2020240930172234.png)
_Рисунок 18 - Доступ Admin к разделу контента ИХ_
##### Этап 2. Удаление комментариев к игре
![Pasted image 20240930174557.png](/img/user/Pasted%20image%2020240930174557.png)
_Рисунок 19 - Успешное удаление комментария к игре_
![Pasted image 20240930173637.png](/img/user/Pasted%20image%2020240930173637.png)
_Рисунок 20 - Доступ Admin к разделу контента ИХ_
##### Этап 3. Удаление комментариев к ИХ
![Pasted image 20240930174742.png](/img/user/Pasted%20image%2020240930174742.png)
_Рисунок 21 - Успешное удаление комментария к ИХ_
![Pasted image 20240930173714.png](/img/user/Pasted%20image%2020240930173714.png)
_Рисунок 22 - Доступ Admin к разделу контента ИХ_
##### Этап 4. Удаление обзора к игре
![Pasted image 20240930174845.png](/img/user/Pasted%20image%2020240930174845.png)
_Рисунок 23 - Успешное удаление обзора к игре_
![Pasted image 20240930173752.png](/img/user/Pasted%20image%2020240930173752.png)
_Рисунок 24 - Доступ Admin к разделу контента ИХ_
**Вывод**: Были удалены комментарии к игре и ИХ. Был удалён обзор к игре. Возникли проблемы с доступом к разделу с контентом ИХ.
**Замечания**: Следует дать роли #Admin полный доступ к разделу с контентом ИХ.
### Заключение
Проверять доступ к просмотру комментариев и контента в сценариях 2-4, созданию комментариев в сценариях 3-4 - нет смысла, так как любой, даже неавторизованный пользователь имеет доступ к просмотру комментариев к игре и ИХ, что было проверено в **Сценарии 1**, а все последующие роли были созданы на основе предыдущей и в данном отчёте располагаются иерархически в обратном порядке, по критерию наличия прав и доступа. Данное правило не противоречит ТЗ, так как именно эта задумка и была изначально представлена в нем же.
Было проверено в общей сложности 4 основных сценария.
Проблемы в успешном выполнении сценариев связаны только с уровнями доступа к управлению отдельных блоков данных, хотя допускаю, что ошибка может быть и в ТЗ, так как в некоторых моментах не были явно указаны требования к ролям #Authenticated и #ContentMaker .
Претензий в остальном, по типу наполнения контентом и связей между сущностями не имею.